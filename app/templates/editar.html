{% extends "base.html" %}

{% block title %}Editar Registro{% endblock %}

{% block content %}
    <h2>Editar Registro</h2>
    <form method="POST">
        <a href="{{ url_for('consulta', query=query) }}" class="back-link">← Volver a la consulta</a>

        {% for label, field in labels_and_fields %}
            <label>{{ label }}</label>
            
            {# --- Lógica para mostrar el campo correcto según el tipo --- #}
            
            {% if field == 'especialidad' %}
                <select name="{{ field }}" required>
                    <option value="">Seleccione una especialidad</option>
                    <option value="CSS" {% if data[field]=='CSS' %}selected{% endif %}>CSS</option>
                    <option value="CYT" {% if data[field]=='CYT' %}selected{% endif %}>CYT</option>
                    <option value="Comunicación" {% if data[field]=='Comunicación' %}selected{% endif %}>Comunicación</option>
                    <option value="DPCC" {% if data[field]=='DPCC' %}selected{% endif %}>DPCC</option>
                    <option value="Ed. Física" {% if data[field]=='Ed. Física' %}selected{% endif %}>Ed. Física</option>
                    <option value="Matemática" {% if data[field]=='Matemática' %}selected{% endif %}>Matemática</option>
                    <option value="Inicial" {% if data[field]=='Inicial' %}selected{% endif %}>Inicial</option>
                    <option value="Primaria" {% if data[field]=='Primaria' %}selected{% endif %}>Primaria</option>
                </select>

            {% elif field == 'modalidad' %}
                <select name="{{ field }}" required>
                    <option value="">Seleccione</option>
                    <option value="Nombramiento" {% if data[field]=='Nombramiento' %}selected{% endif %}>Nombramiento</option>
                    <option value="Ascenso" {% if data[field]=='Ascenso' %}selected{% endif %}>Ascenso</option>
                    <option value="Ascenso + Cargos" {% if data[field]=='Ascenso + Cargos' %}selected{% endif %}>Ascenso + Cargos</option>
                    <option value="Cargos directivos" {% if data[field]=='Cargos directivos' %}selected{% endif %}>Cargos directivos</option>
                    <option value="Maratón" {% if data[field]=='Maratón' %}selected{% endif %}>Maratón</option>
                    <option value="Maratón + Ascenso" {% if data[field]=='Maratón + Ascenso' %}selected{% endif %}>Maratón + Ascenso</option>
                </select>

            {% elif field == 'destino' %}
                <select name="{{ field }}">
                    <option value="">Seleccione un destino</option>
                    <option value="Laly" {% if data[field]=='Laly' %}selected{% endif %}>Laly</option>
                    <option value="Darcing" {% if data[field]=='Darcing' %}selected{% endif %}>Darcing</option>
                    <option value="CECP" {% if data[field]=='CECP' %}selected{% endif %}>CECP</option>
                    <option value="Keila" {% if data[field]=='Keila' %}selected{% endif %}>Keila</option>
                </select>

            {% elif field == 'tipo_de_cuota' %}
                <select name="{{ field }}" required>
                    <option value="">Seleccione</option>
                    <option value="1" {% if data[field]|string == '1' %}selected{% endif %}>1</option>
                    <option value="2" {% if data[field]|string == '2' %}selected{% endif %}>2</option>
                    <option value="Completo" {% if data[field]|string == 'Completo' %}selected{% endif %}>Completo</option>
                </select>

            {% elif field == 'genero' %}
                <select name="{{ field }}" required>
                    <option value="">Seleccione</option>
                    <option value="Masculino" {% if data[field]=='Masculino' %}selected{% endif %}>M</option>
                    <option value="Femenino" {% if data[field]=='Femenino' %}selected{% endif %}>F</option>
                    <option value="Otro" {% if data[field]=='Otro' %}selected{% endif %}>Otro</option>
                </select>
                
            {% elif field == 'fecha' %}
                <input type="date" name="{{ field }}" value="{{ data[field].strftime('%Y-%m-%d') if data[field] else '' }}">

            {% elif field == 'cuota' %}
                <input type="number" step="0.01" name="{{ field }}" value="{{ data[field] or '' }}">

            {% elif field == 'correo' %}
                <input type="email" name="{{ field }}" value="{{ data[field] or '' }}">
                
            {% else %}
                <input type="text" name="{{ field }}" value="{{ data[field] or '' }}">

            {% endif %}
        {% endfor %}

        <input type="hidden" name="query" value="{{ query }}">
        <button type="submit">Guardar Cambios</button>
    </form>
{% endblock %}